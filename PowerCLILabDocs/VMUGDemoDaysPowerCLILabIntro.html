<html><head><title>VMUGDemoDays - PowerCLI Lab Intro</title><style type="text/css">ol{margin:0;padding:0}.c1{vertical-align:top;width:291pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c4{vertical-align:top;width:121.5pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c7{vertical-align:top;width:73.5pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c8{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c11{list-style-type:disc;margin:0;padding:0}.c6{padding-left:0pt;margin-left:36pt}.c9{color:#1155cc;text-decoration:underline}.c2{color:inherit;text-decoration:inherit}.c10{border-collapse:collapse}.c0{direction:ltr}.c3{line-height:1.0}.c5{height:11pt}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:left;color:#666666;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Arial";padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:left;color:#666666;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:10pt;font-family:"Arial";padding-bottom:2pt}</style></head><body class="c8"><h2 class="c0"><a name="h.8d2ge5wj3fki"></a><span>PowerCLI 102 / 201 Lab Introduction</span></h2><p class="c0 c5"><span></span></p><p class="c0"><span>This is a PowerCLI 102 / 201 lab. &nbsp;Assumptions:</span></p><ol class="c11" start="1"><li class="c0 c6"><span>you are familiar with VMware and the vSphere inventory -- objects, folders, actions to be taken, etc.</span></li><li class="c6 c0"><span>you have heard of and used PowerShell and VMware PowerCLI, at least some</span></li></ol><p class="c0 c5"><span></span></p><p class="c0"><span>VMware vSphere PowerCLI is available by following the link </span><span class="c9"><a class="c2" href="http://vmware.com/go/PowerCLI">http://vmware.com/go/PowerCLI</a></span><span>. &nbsp;This gets you to the VMware vSphere PowerCLI VMTN Community page, which has download links, the discussions forum, documents, etc. &nbsp;In general, if you have PowerCLI questions, that community is the spot. &nbsp;LucD, RvdN, HalR, Virtu-Al -- all the top guys frequent the community.</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>As for the version of PowerShell to use, PowerCLI v5 requires at least PowerShell v2 -- PowerCLI v5 does not support using PowerShell v1. &nbsp;If the machine on which PowerShell is running is fairly current, it likely will have PowerShell v2 (v2 was released in Aug 2009). &nbsp;If not, the newer PowerShell is available for download from microsoft.com (</span><span class="c9"><a class="c2" href="http://support.microsoft.com/kb/968929">http://support.microsoft.com/kb/968929</a></span><span>&nbsp;for v2).</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>When installing PowerCLI on a 64-bit Windows, two versions get installed: &nbsp;one for running in 32-bit PowerShell, and one for 64-bit PowerShell. &nbsp;Currently, the 32-bit version is required for cmdlets that interact with VM guests&#39; operating systems via VMware Tools and the VIX API (</span><span class="c9"><a class="c2" href="http://www.vmware.com/support/developer/vix-api/).">http://www.vmware.com/support/developer/vix-api/</a></span><span>).</span></p><p class="c0 c5"><span></span></p><p class="c0 c5"><span></span></p><h3 class="c0"><a name="h.xuckqmwvbwr9"></a><span>PowerShell Refresher/Overview, if you forgot</span></h3><p class="c0"><span>PowerShell uses cmdlets: &nbsp;&quot;specialized commands in the PowerShell environment that implement specific functions&quot; (ref: &nbsp;wikipedia.org). &nbsp;They are named in a verb-noun naming pattern.</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>Items in PowerShell are objects. &nbsp;Part of the power of PowerShell is the power of the pipeline -- acting on objects via cmdlets / functions / .NET methods, piping those resultant objects to another cmdlet / function / method, and so on.</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>Some common aliases used in this lab:</span></p><p class="c0 c5"><span></span></p><a href="#" name="9bcbe5327f41e4f8f5c972848bbf4d9f3ee99faf"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0" class="c10"><tbody><tr><td class="c7"><p class="c0 c3"><span>Alias</span></p></td><td class="c4"><p class="c0 c3"><span>Cmdlet</span></p></td><td class="c1"><p class="c0 c3"><span>Use</span></p></td></tr><tr><td class="c7"><p class="c0 c3"><span>%</span></p></td><td class="c4"><p class="c0 c3"><span>Foreach-Object</span></p></td><td class="c1"><p class="c0 c3"><span>Iterating over one or more object</span></p></td></tr><tr><td class="c7"><p class="c0 c3"><span>?, Where</span></p></td><td class="c4"><p class="c0 c3"><span>Where-Object</span></p></td><td class="c1"><p class="c0 c3"><span>Filtering objects</span></p></td></tr><tr><td class="c7"><p class="c0 c3"><span>ft</span></p></td><td class="c4"><p class="c0 c3"><span>Format-Table</span></p></td><td class="c1"><p class="c0 c3"><span>Formatting output</span></p></td></tr><tr><td class="c7"><p class="c0 c3"><span>measure</span></p></td><td class="c4"><p class="c0 c3"><span>Measure-Object</span></p></td><td class="c1"><p class="c0 c3"><span>Measuring numeric properties of objects</span></p></td></tr><tr><td class="c7"><p class="c0 c3"><span>select</span></p></td><td class="c4"><p class="c0 c3"><span>Select-Object</span></p></td><td class="c1"><p class="c0 c3"><span>Selecting specified properties of objects</span></p></td></tr><tr><td class="c7"><p class="c0 c3"><span>sort</span></p></td><td class="c4"><p class="c0 c3"><span>Sort-Object</span></p></td><td class="c1"><p class="c0 c3"><span>Sorting objects by property values</span></p></td></tr></tbody></table><p class="c0 c5"><span></span></p><h3 class="c0"><a name="h.cekro0ep7yw0"></a><span>Calculated Properties</span></h3><p class="c0"><span>A calculated property is one that is created by giving an expression to be evaluated using existing properties of objects. &nbsp;A simple example: &nbsp;say an object has a property &quot;SizeMB&quot;, but we want to report the SizeGB of the object. &nbsp;This can be done using a calculated property as such:</span></p><p class="c0"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS C:\&gt; $objMyDiskInfo | Select-Object Name, @{n = &quot;SizeGB&quot;; e={$_.SizeMB / 1KB}}</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>The hash-table at the end of the Select-Object statement will return a property named &quot;SizeGB&quot; that is calculated by evaluating the expression &quot;$_.SizeMB / 1KB&quot;.</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>Calculated properties are mandatory for getting desired results that do not already exist in a property of an object.</span></p><p class="c0 c5"><span></span></p><p class="c0"><span>Alright, go do the lab!</span></p></body></html>